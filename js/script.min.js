function resizeTextArea(e){const{style:t,value:n}=e;t.height=t.minHeight="auto",t.minHeight=`${Math.min(e.scrollHeight+4,parseInt(e.style.maxHeight))}px`,t.height=`${e.scrollHeight+4}px`}const inputContainer=document.querySelector(".input-container"),input=document.getElementById("text");input.addEventListener("input",()=>{input.setAttribute("value",input.value),resizeTextArea(input),""!==input.value?inputContainer.classList.add("has-value"):inputContainer.classList.remove("has-value")}),FilePond.registerPlugin(FilePondPluginImageExifOrientation,FilePondPluginImagePreview,FilePondPluginPdfPreview,FilePondPluginMediaPreview,FilePondPluginGetFile),FilePond.setOptions({server:{process:(e,t,n,a,o,s,p,i,r)=>{const u=new FormData;u.append("type","upload"),u.append("fieldName",e),u.append("file",t),u.append("name",t.name);const d=new XMLHttpRequest;return d.open("POST","php/server.php"),d.upload.onprogress=(e=>{s(!1,e.loaded,e.total)}),d.onload=function(){d.status>=200&&d.status<300?a(d.responseText):o("oh no")},d.send(u),{abort:()=>{d.abort(),p()}}},revert:(e,t,n)=>{const a=new FormData;a.append("type","revert"),a.append("id",e);const o=new XMLHttpRequest;o.open("POST","php/server.php"),o.onload=function(){o.status>=200&&o.status<300?t():n("oh my goodness")},o.send(a)},remove:(e,t,n)=>{const a=new FormData;a.append("type","remove"),a.append("path",e);const o=new XMLHttpRequest;o.open("POST","php/server.php"),o.onload=function(){o.status>=200&&o.status<300?t():n("oh my goodness")},o.send(a)},load:(e,t,n,a,o,s)=>{var p=new Request(e);fetch(p).then(e=>e.blob()).then(t)}}});const inputElement=document.querySelector('input[type="file"]'),pond=FilePond.create(inputElement,{allowDownloadByUrl:!1,pdfComponentExtraParams:"toolbar=0&view=fitW&page=1"});function sendText(){const e=new FormData;e.append("type","updatetext"),e.append("text",Base64.encode(document.getElementById("text").value));const t=new XMLHttpRequest;t.open("POST","php/server.php"),t.send(e)}function updateFiles(e){const t=pond.getFiles();e.forEach(e=>{t.find(t=>t.getMetadata("name")===e.substring(8)||t.source.name===e.substring(8))||pond.addFile(e,{type:"local",metadata:{name:e.substring(8)}})}),t.forEach(t=>{if(5==t.status){e.some(e=>t.getMetadata("name")===e.substring(8)||t.source.name===e.substring(8))||pond.removeFile(t)}})}var source=new EventSource("php/stream.php");source.onmessage=function(e){const t=JSON.parse(Base64.decode(e.data));document.getElementById("text").value=Base64.decode(t.text),input.dispatchEvent(new Event("input")),updateFiles(t.files)};